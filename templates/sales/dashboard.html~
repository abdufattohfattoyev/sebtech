{% extends "base.html" %}

{% block page_title %}Sotuvlar Dashboard{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-3 mb-3">
        <div class="card h-100 card-hover" onclick="window.location.href='{% url 'sales:phone_sale_list' %}'" style="cursor: pointer;">
            <div class="card-body text-center">
                <i class="fas fa-mobile-alt text-primary mb-3" style="font-size: 2.5rem;"></i>
                <h3 class="card-title text-primary mb-2">{{ today_phone_sales_count }}</h3>
                <p class="card-text text-muted mb-2">Bugungi telefon sotuvlari</p>
                <h5 class="text-success fw-bold mb-0">${{ today_phone_sales_total|floatformat:2 }}</h5>
                <small class="text-muted">Umumiy summa</small>
            </div>
            <div class="card-footer bg-light text-center">
                <small class="text-primary">
                    <i class="fas fa-eye me-1"></i>Batafsil ko'rish
                </small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card h-100 card-hover" onclick="window.location.href='{% url 'sales:accessory_sale_list' %}'" style="cursor: pointer;">
            <div class="card-body text-center">
                <i class="fas fa-headphones text-info mb-3" style="font-size: 2.5rem;"></i>
                <h3 class="card-title text-info mb-2">{{ today_accessory_sales_count }}</h3>
                <p class="card-text text-muted mb-2">Bugungi aksessuar sotuvlari</p>
                <h5 class="text-success fw-bold mb-0">${{ today_accessory_sales_total|floatformat:2 }}</h5>
                <small class="text-muted">Umumiy summa</small>
            </div>
            <div class="card-footer bg-light text-center">
                <small class="text-info">
                    <i class="fas fa-eye me-1"></i>Batafsil ko'rish
                </small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card h-100 card-hover" onclick="window.location.href='{% url 'sales:debt_list' %}'" style="cursor: pointer;">
            <div class="card-body text-center">
                <i class="fas fa-hand-holding-usd text-warning mb-3" style="font-size: 2.5rem;"></i>
                <h3 class="card-title text-warning mb-2">{{ active_debts_count }}</h3>
                <p class="card-text text-muted mb-2">Aktiv qarzlar</p>
                <h5 class="text-warning fw-bold mb-0">${{ active_debts_total|floatformat:2 }}</h5>
                <small class="text-muted">Umumiy qarz</small>
            </div>
            <div class="card-footer bg-light text-center">
                <small class="text-warning">
                    <i class="fas fa-eye me-1"></i>Batafsil ko'rish
                </small>
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-3">
        <div class="card h-100 card-hover" onclick="window.location.href='{% url 'sales:expense_list' %}'" style="cursor: pointer;">
            <div class="card-body text-center">
                <i class="fas fa-receipt text-danger mb-3" style="font-size: 2.5rem;"></i>
                <h3 class="card-title text-danger mb-2">${{ today_expenses_total|floatformat:2 }}</h3>
                <p class="card-text text-muted mb-2">Bugungi xarajatlar</p>
                <div class="mt-2">
                    <small class="text-muted">Umumiy summa</small>
                </div>
            </div>
            <div class="card-footer bg-light text-center">
                <small class="text-danger">
                    <i class="fas fa-eye me-1"></i>Batafsil ko'rish
                </small>
            </div>
        </div>
    </div>
</div>

<!-- Bugungi natijalar jadvali -->
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>Bugungi natijalar
                </h5>
                <span class="badge bg-primary">{% now "d.m.Y" %}</span>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead class="table-light">
                                    <tr>
                                        <th>Ko'rsatkich</th>
                                        <th class="text-end">Soni</th>
                                        <th class="text-end">Summa</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <i class="fas fa-mobile-alt text-primary me-2"></i>
                                            Telefon sotuvlari
                                        </td>
                                        <td class="text-end">
                                            <span class="badge bg-primary">{{ today_phone_sales_count }}</span>
                                        </td>
                                        <td class="text-end text-success fw-bold">
                                            ${{ today_phone_sales_total|floatformat:2 }}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <i class="fas fa-headphones text-info me-2"></i>
                                            Aksessuar sotuvlari
                                        </td>
                                        <td class="text-end">
                                            <span class="badge bg-info">{{ today_accessory_sales_count }}</span>
                                        </td>
                                        <td class="text-end text-success fw-bold">
                                            ${{ today_accessory_sales_total|floatformat:2 }}
                                        </td>
                                    </tr>
                                    <tr class="table-warning">
                                        <td>
                                            <i class="fas fa-receipt text-danger me-2"></i>
                                            Xarajatlar
                                        </td>
                                        <td class="text-end">-</td>
                                        <td class="text-end text-danger fw-bold">
                                            -${{ today_expenses_total|floatformat:2 }}
                                        </td>
                                    </tr>
                                    <tr class="table-success">
                                        <td class="fw-bold">
                                            <i class="fas fa-coins text-warning me-2"></i>
                                            Sof foyda
                                        </td>
                                        <td class="text-end">-</td>
                                        <td class="text-end fw-bold">
                                            ${{ net_profit|floatformat:2 }}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="bg-light p-3 rounded">
                            <h6 class="text-muted mb-3">Qarz holati</h6>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Aktiv qarzlar:</span>
                                <span class="fw-bold text-warning">{{ active_debts_count }} ta</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Umumiy qarz summasi:</span>
                                <span class="fw-bold text-danger">${{ active_debts_total|floatformat:2 }}</span>
                            </div>
                            <hr>
                            <div class="text-center">
                                <a href="{% url 'sales:debt_list' %}" class="btn btn-sm btn-outline-warning">
                                    <i class="fas fa-list me-1"></i>Barcha qarzlar
                                </a>
                                <a href="{% url 'sales:debt_payment_list' %}" class="btn btn-sm btn-outline-success">
                                    <i class="fas fa-dollar-sign me-1"></i>To'lovlar
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-plus-circle me-2"></i>Tezkor amallar
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-2">
                    <div class="col-6">
                        <a href="{% url 'sales:phone_sale_create' %}" class="btn btn-primary w-100">
                            <i class="fas fa-mobile-alt mb-1"></i><br>
                            <small>Telefon sotish</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:accessory_sale_create' %}" class="btn btn-info w-100">
                            <i class="fas fa-headphones mb-1"></i><br>
                            <small>Aksessuar sotish</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:phone_exchange_create' %}" class="btn btn-warning w-100">
                            <i class="fas fa-exchange-alt mb-1"></i><br>
                            <small>Telefon almashtirish</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:phone_return_create' %}" class="btn btn-secondary w-100">
                            <i class="fas fa-undo mb-1"></i><br>
                            <small>Telefon qaytarish</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>Boshqaruv
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-2">
                    <div class="col-6">
                        <a href="{% url 'sales:debt_list' %}" class="btn btn-outline-warning w-100">
                            <i class="fas fa-hand-holding-usd mb-1"></i><br>
                            <small>Qarzlar</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:debt_payment_list' %}" class="btn btn-outline-success w-100">
                            <i class="fas fa-dollar-sign mb-1"></i><br>
                            <small>Qarz to'lovlari</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:expense_list' %}" class="btn btn-outline-danger w-100">
                            <i class="fas fa-receipt mb-1"></i><br>
                            <small>Xarajatlar</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'sales:expense_create' %}" class="btn btn-outline-info w-100">
                            <i class="fas fa-plus mb-1"></i><br>
                            <small>Xarajat qo'shish</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card-hover {
    transition: all 0.3s ease;
}

.card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.card-hover:hover .card-footer {
    background-color: #e3f2fd !important;
}

.table td, .table th {
    vertical-align: middle;
}

@media (max-width: 768px) {
    .card-hover {
        margin-bottom: 1rem;
    }

    .btn {
        font-size: 0.8rem;
        padding: 0.5rem;
    }
}
</style>

{% endblock %}